name: Debug NSE Analysis

on: [workflow_dispatch]

jobs:
  debug:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: Install pandas
      run: pip install pandas
    
    - name: Download historical data artifact (if exists)
      uses: actions/download-artifact@v4
      continue-on-error: true
      with:
        name: xml-historical-data
        path: data/processed/
    
    - name: Debug data directory
      run: |
        echo "=== Debug Information ==="
        echo "Current directory: $(pwd)"
        echo ""
        echo "=== Directory structure ==="
        find . -type f -name "*.csv" -o -name "*.txt" | grep -E "(data|outputs)" | sort || echo "No data files found"
        echo ""
        echo "=== Processed data directory ==="
        if [ -d "data/processed" ]; then
          echo "✅ Directory exists"
          ls -la data/processed/
          
          if ls data/processed/*.csv 1> /dev/null 2>&1; then
            echo ""
            echo "=== CSV File Details ==="
            for file in data/processed/*.csv; do
              echo "File: $(basename $file)"
              echo "Size: $(wc -l < $file) lines"
              echo "Modified: $(stat -c %y $file)"
              echo "---"
            done
          else
            echo "❌ No CSV files found in processed directory"
          fi
        else
          echo "❌ Directory doesn't exist (artifact not downloaded or first run)"
        fi
